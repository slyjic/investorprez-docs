# üöÄ InvestorPrez Deployment Guide - Complete

*Last Updated: July 23, 2025*  
*Status: Current - v1.4.0 Enterprise Infrastructure*  
*Consolidates: DEPLOYMENT_GUIDE.md, PRODUCTION_DEPLOYMENT_STEPS.md, PRODUCTION_DEPLOYMENT_CHECKLIST.md*

---

## üìã Pre-Deployment Checklist

### **Development Verification**
- [ ] All features tested in local development environment
- [ ] TypeScript compilation passes (`npm run build`)
- [ ] All tests passing (`npm test`)
- [ ] No console errors in production build
- [ ] Asset uploads working with Vercel Blob storage

### **Infrastructure Preparation**
- [ ] Vercel account configured with custom domain (app.investorprez.com)
- [ ] Railway account configured with custom domain (api.investorprez.com)
- [ ] PostgreSQL database accessible and migrated
- [ ] Vercel Blob storage token generated
- [ ] All environment variables documented and ready

### **Security Verification**
- [ ] All secrets stored securely (not in code)
- [ ] CORS origins configured for production domains
- [ ] Rate limiting configured and tested
- [ ] SSL certificates active for custom domains

---

## üèóÔ∏è Infrastructure Overview

### **Production Architecture**
- **Frontend**: Vercel hosting with custom domain (app.investorprez.com)
- **Backend**: Railway hosting with custom domain (api.investorprez.com)
- **Database**: Railway PostgreSQL with automated backups
- **Storage**: Vercel Blob with global CDN
- **Monitoring**: Sentry error tracking + Google Analytics 4
- **Email**: Resend service integration

### **Auto-Deployment Flow**
1. Push to `main` branch triggers automatic deployments
2. Vercel builds and deploys frontend changes
3. Railway builds and deploys backend changes
4. Database migrations run automatically if configured

---

## üöÄ Step-by-Step Deployment

### **Step 1: Environment Variables Setup**

#### **1.1 Vercel (Frontend) Variables**
Go to: [Vercel Dashboard ‚Üí Project ‚Üí Settings ‚Üí Environment Variables](https://vercel.com/dashboard)

```bash
# Required Variables
NODE_ENV=production
VITE_API_BASE_URL=https://api.investorprez.com/api
VITE_GA_MEASUREMENT_ID=your-ga-measurement-id

# Optional: Sentry Frontend
VITE_SENTRY_DSN=your_frontend_sentry_dsn_here
```

#### **1.2 Railway (Backend) Variables**
Go to: Railway Dashboard ‚Üí Backend Service ‚Üí Variables

```bash
# Database (Auto-configured by Railway)
DATABASE_URL=postgresql://... (auto-generated by Railway)

# Required Application Variables
JWT_SECRET=your_super_secure_jwt_secret_here
RESEND_API_KEY=re_your_resend_api_key_here
FRONTEND_URL=https://app.investorprez.com
NODE_ENV=production

# Storage
BLOB_READ_WRITE_TOKEN=vercel_blob_rw_YOUR_ACTUAL_TOKEN_HERE

# Monitoring (v1.4.0)
SENTRY_DSN=your_backend_sentry_dsn_here
GA_MEASUREMENT_ID=your-ga-measurement-id
```

### **Step 2: Database Setup**

#### **2.1 Railway PostgreSQL Configuration**
1. Railway automatically provisions PostgreSQL database
2. `DATABASE_URL` environment variable is auto-configured
3. Database accessible via Railway dashboard SQL editor

#### **2.2 Run Database Migrations**
```bash
# Option A: Via Railway CLI
railway login
railway link [your-project-id]
railway run --service=backend npm run db:migrate

# Option B: Via Railway Dashboard
# Go to PostgreSQL service ‚Üí Connect ‚Üí psql
# Copy and paste migration SQL manually
```

#### **2.3 Verify Database Schema**
Ensure these tables exist:
- `users` (authentication and profiles)
- `presentations` (presentation data and metadata)
- `assets` (file references and blob URLs)

### **Step 3: Storage Configuration**

#### **3.1 Vercel Blob Token Setup**
1. Go to [Vercel Dashboard](https://vercel.com/dashboard)
2. Navigate to Blob storage section
3. Create new token with Read & Write permissions
4. Copy token (starts with `vercel_blob_rw_`)
5. Add to both Vercel and Railway environment variables

#### **3.2 Test Storage Integration**
```bash
# Test locally first
BLOB_READ_WRITE_TOKEN=your_token npm run dev
# Try uploading an asset in the editor
```

### **Step 4: Custom Domain Setup**

#### **4.1 Frontend Domain (Vercel)**
1. Vercel Dashboard ‚Üí Project ‚Üí Settings ‚Üí Domains
2. Add custom domain: `app.investorprez.com`
3. Configure DNS CNAME: `app.investorprez.com` ‚Üí `cname.vercel-dns.com`
4. Wait for SSL certificate provisioning

#### **4.2 Backend Domain (Railway)**
1. Railway Dashboard ‚Üí Backend Service ‚Üí Settings ‚Üí Domains
2. Add custom domain: `api.investorprez.com`  
3. Configure DNS CNAME: `api.investorprez.com` ‚Üí `[your-railway-app].railway.app`
4. Wait for SSL certificate provisioning

### **Step 5: Monitoring Setup (v1.4.0)**

#### **5.1 Sentry Error Tracking**
1. Create Sentry project for InvestorPrez
2. Get DSN for both frontend and backend
3. Add Sentry DSN to environment variables
4. Deploy and verify error tracking in Sentry dashboard

#### **5.2 Google Analytics 4**
1. GA4 already configured with ID: `your-ga-measurement-id`
2. Verify tracking in GA4 dashboard after deployment
3. Check conversion events for signup and presentation creation

### **Step 6: Deployment Execution**

#### **6.1 Frontend Deployment (Vercel)**
```bash
# Automatic via Git
git push origin main

# Manual deployment (alternative)
npx vercel --prod
```

#### **6.2 Backend Deployment (Railway)**
```bash
# Automatic via Git (recommended)
git push origin main

# Railway CLI deployment (alternative)
railway up --service=backend
```

### **Step 7: Post-Deployment Verification**

#### **7.1 Health Checks**
- [ ] Frontend loads: https://app.investorprez.com
- [ ] API responds: https://api.investorprez.com/health
- [ ] Database connection working
- [ ] Authentication flow functional (signup/login)
- [ ] Presentation editor loads without errors

#### **7.2 Feature Verification**
- [ ] Create test presentation and save
- [ ] Upload test asset (image/file)
- [ ] Publish presentation and verify public access
- [ ] Typography presets accessible and functional
- [ ] User registration and email verification working

#### **7.3 Monitoring Verification**
- [ ] Sentry receiving error events (create test error if needed)
- [ ] GA4 tracking user actions and page views
- [ ] Performance metrics showing in monitoring dashboards

---

## üö® Common Deployment Issues & Solutions

### **Environment Variable Issues**
```bash
# Issue: CORS errors
# Solution: Verify FRONTEND_URL matches actual domain
FRONTEND_URL=https://app.investorprez.com

# Issue: Database connection failed
# Solution: Check DATABASE_URL in Railway variables
# Ensure PostgreSQL service is running
```

### **Asset Upload Issues**
```bash
# Issue: Asset uploads failing
# Solution: Verify Vercel Blob token is correct
# Check BLOB_READ_WRITE_TOKEN in Railway variables
# Ensure token has Read & Write permissions
```

### **Build Issues**
```bash
# Issue: TypeScript compilation errors
# Solution: Standard build command
npm run build

# Issue: Missing dependencies
# Solution: Clear cache and reinstall
rm -rf node_modules package-lock.json
npm install
```

### **Custom Domain Issues**
```bash
# Issue: Domain not resolving
# Solution: Verify DNS configuration
# CNAME records must point to correct hosting provider
# Wait up to 48 hours for DNS propagation
```

---

## üìä Production Configuration Summary

### **Current Production Status (v1.4.0)**
- **Frontend**: ‚úÖ Live at https://app.investorprez.com
- **Backend**: ‚úÖ Live at https://api.investorprez.com  
- **Database**: ‚úÖ Railway PostgreSQL with auto-backups
- **Storage**: ‚úÖ Vercel Blob with global CDN
- **Monitoring**: ‚úÖ Sentry + GA4 active
- **SSL**: ‚úÖ Automatic HTTPS on both domains

### **Performance Metrics**
- **Frontend Load Time**: < 2 seconds (94% bundle reduction achieved)
- **API Response Time**: < 500ms average
- **Database Queries**: Optimized with indexes
- **Asset Loading**: Global CDN distribution

### **Security Features**
- **HTTPS**: Enforced on all domains
- **CORS**: Properly configured for custom domains  
- **Rate Limiting**: 1000 requests per 15-minute window
- **JWT Authentication**: Secure token-based auth
- **Password Hashing**: bcrypt with secure rounds

---

## üîß Maintenance & Updates

### **Regular Deployment Process**
1. Develop and test changes locally
2. Commit to feature branch
3. Create pull request for review
4. Merge to `main` for automatic deployment
5. Monitor deployment in Vercel/Railway dashboards
6. Verify functionality in production

### **Database Migrations**
```bash
# Create new migration
# Add SQL file to backend/database/migrations/
# Deploy via Railway CLI or dashboard
railway run --service=backend npm run db:migrate
```

### **Environment Variable Updates**
1. Update variables in Vercel/Railway dashboards
2. Services automatically restart with new variables
3. Verify changes take effect in production

---

*This consolidated guide replaces multiple overlapping deployment documents and provides complete, current instructions for InvestorPrez v1.4.0 deployment.*